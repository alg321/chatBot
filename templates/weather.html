<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Weather</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
     <!-- JavaScript for Chatbot -->
    <script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha384-5e2ESR8Ycmos6g3gAKr1Jvwye8sW4U1u/cAKulfVJnkakCcMqhOudbtPnvJ+nbv7" crossorigin="anonymous">
</head>
<body>
    <div class="relative h-screen">
        <nav class="back-nav">
            <a href="/index" class="text-white">
                <i class="fa-solid fa-backward-step fa-beat"></i>
            </a>
        </nav>
        <div class="background-image"></div>
        <div class="weather-container">
            {% for name, country, current_weather, forecast_weather in weather_data_list %}
            <div class="city-header">
                <h1 class="city-title">{{ name.title() }}</h1>
                <h5 class="date">{{ current_weather.date }}</h5>
            </div>
            <div class="current-weather">
                <table class="weather-table">
                    <thead>
                        <tr>
                            <th colspan="2" class="icon-cell">
                                <img src="https://openweathermap.org/img/wn/{{ current_weather.icon }}@2x.png" alt="Icon">
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Description:</td>
                            <td>{{ current_weather.description.title() }}</td>
                        </tr>
                        <tr>
                            <td>Temperature:</td>
                            <td>{{ current_weather.temperature }}°C</td>
                        </tr>
                        <tr>
                            <td>Min: {{ current_weather.temp_min }}°C</td>
                            <td>Max: {{ current_weather.temp_max }}°C</td>
                        </tr>
                        <tr>
                            <td>Humidity:</td>
                            <td>{{ current_weather.humidity }}%</td>
                        </tr>
                        <tr>
                            <td>Sunrise:</td>
                            <td>{{ current_weather.sunrise }}</td>
                        </tr>
                        <tr>
                            <td>Sunset:</td>
                            <td>{{ current_weather.sunset }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="forecast-weather">
                {% for forecast in forecast_weather %}
                <div class="forecast-item">
                    <p>{{ forecast.forecast_time.strftime('%d/%m/%Y') }}</p>
                    <p>Min: {{ forecast.temp_min }}°C</p>
                    <p>Max: {{ forecast.temp_max }}°C</p>
                    <p>{{ forecast.description.title() }}</p>
                    <img src="http://openweathermap.org/img/wn/{{ forecast.icon }}@2x.png" alt="Weather icon">
                </div>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Chatbot Pop-Up Modal -->
    <div id="chatbotModal" class="chatbot-modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeChatbot()">&times;</span>
            <div id="chatWindow" class="chat-window">
                <!-- Chat messages will go here -->
            </div>
            <div class="input-container">
                <input type="text" id="userInput" class="chat-input" placeholder="Ask me about the weather..." onkeypress="handleKeyPress(event)">
                <button onclick="sendMessage()" class="send-button">Send</button>
            </div>
        </div>
    </div>
    <!-- Button to Open the Modal -->
    <button id="chatbotBtn" class="chatbot-btn" onclick="openChatbot()">Chat with WeatherBot</button>
</body>
</html>
